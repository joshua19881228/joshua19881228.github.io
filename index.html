<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
<meta property="og:type" content="website">
<meta property="og:title" content="Joshua&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Joshua&#39;s Blog">
<meta property="og:description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Joshua LI">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Joshua's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Joshua's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-my-jumble-of-computer-vision">

    <a href="/2016/08/25/Computer_Vision/2016-08-25-my-jumble-of-computer-vision/" rel="section"><i class=" fa-fw"></i>My Jumble of Computer Vision</a>

  </li>
        <li class="menu-item menu-item-an-introduction-to-cnn-based-object-detection">

    <a href="/2017/06/13/Computer_Vision/2017-06-13-An-Introduction-to-CNN-based-Object-Detection/" rel="section"><i class=" fa-fw"></i>An Introduction to CNN based Object Detection</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/25/Coding/RK3399/2021-07-25-D4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/25/Coding/RK3399/2021-07-25-D4/" class="post-title-link" itemprop="url">D4:RK3399上MNN的OpenCL推理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-25 13:11:00" itemprop="dateCreated datePublished" datetime="2021-07-25T13:11:00+08:00">2021-07-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>目前还没有完全确认使用的正确性，使用OpenCL的推理速度远慢于CPU的推理速度</p>
<h1 id="D4-RK3399上MNN的OpenCL推理"><a href="#D4-RK3399上MNN的OpenCL推理" class="headerlink" title="D4: RK3399上MNN的OpenCL推理"></a>D4: RK3399上MNN的OpenCL推理</h1><h2 id="1-MNN的OpenCL支持"><a href="#1-MNN的OpenCL支持" class="headerlink" title="1. MNN的OpenCL支持"></a>1. MNN的OpenCL支持</h2><p>可以在CMakeLists.txt里直接修改，打开OpenCL支持</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># backend options</span></span><br><span class="line"><span class="keyword">option</span>(MNN_METAL <span class="string">"Enable Metal"</span> <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">option</span>(MNN_OPENCL <span class="string">"Enable OpenCL"</span> <span class="keyword">ON</span>)</span><br><span class="line"><span class="keyword">option</span>(MNN_OPENGL <span class="string">"Enable OpenGL"</span> <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">option</span>(MNN_VULKAN <span class="string">"Enable Vulkan"</span> <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">option</span>(MNN_ARM82 <span class="string">"Enable ARM82"</span> <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">option</span>(MNN_ONEDNN <span class="string">"Enable oneDNN"</span> <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">option</span>(MNN_AVX512 <span class="string">"Enable AVX512"</span> <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">option</span>(MNN_CUDA <span class="string">"Enable CUDA"</span> <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">option</span>(MNN_TENSORRT <span class="string">"Enable TensorRT"</span> <span class="keyword">OFF</span>)</span><br><span class="line"><span class="keyword">option</span>(MNN_COREML <span class="string">"Enable CoreML"</span> <span class="keyword">OFF</span>)</span><br></pre></td></tr></table></figure>
<p>如果是交叉编译，为了方便起见，关闭<code>MNN_USE_SYSTEM_LIB</code>不使用系统中的依赖库</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># build options</span></span><br><span class="line"><span class="keyword">option</span>(MNN_USE_SYSTEM_LIB <span class="string">"For opencl and vulkan, use system lib or use dlopen"</span> <span class="keyword">OFF</span>)</span><br></pre></td></tr></table></figure>
<p>编译后会生成libMNN_CL.so库。</p>
<h2 id="2-MNN推理配置"><a href="#2-MNN推理配置" class="headerlink" title="2. MNN推理配置"></a>2. MNN推理配置</h2><p>在创建会话的时候，通过修改配置，让MNN使用OpenCL进行推理。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;MNN::Interpreter&gt; <span class="title">net</span><span class="params">(MNN::Interpreter::createFromFile(_param_path.c_str()))</span></span>;</span><br><span class="line">MNN::ScheduleConfig <span class="built_in">config</span>;</span><br><span class="line"><span class="built_in">config</span>.type = MNN_FORWARD_OPENCL; </span><br><span class="line">session = net-&gt;createSession(<span class="built_in">config</span>);</span><br></pre></td></tr></table></figure>
<h2 id="3-主函数修改"><a href="#3-主函数修改" class="headerlink" title="3. 主函数修改"></a>3. 主函数修改</h2><p>为了能够正确调用OpenCL，需要在main函数中手动加载libMNN_CL.so库。否则MNN会报错找不到OpenCL backend。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;dlfcn.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dlopen(<span class="string">"libMNN_CL.so"</span>, RTLD_NOW);</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/16/Coding/RK3399/2021-07-16-D3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/16/Coding/RK3399/2021-07-16-D3/" class="post-title-link" itemprop="url">D3:MNN和OpenCV编译</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-16 20:14:00" itemprop="dateCreated datePublished" datetime="2021-07-16T20:14:00+08:00">2021-07-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>踩了两个坑，一个是MNN的交叉编译，一个是OpenCV的编译。编译方法都很直接，主要记录一下坑吧。</p>
<h1 id="D3-MNN和OpenCV编译"><a href="#D3-MNN和OpenCV编译" class="headerlink" title="D3: MNN和OpenCV编译"></a>D3: MNN和OpenCV编译</h1><h2 id="1-MNN的交叉编译"><a href="#1-MNN的交叉编译" class="headerlink" title="1. MNN的交叉编译"></a>1. MNN的交叉编译</h2><p>其实直接参照<a href="">MNN文档</a>的示例，就可以编译完成。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">export cross_compile_toolchain=linaro/aarch64</span><br><span class="line">mkdir build &amp;&amp; cd build</span><br><span class="line">cmake .. \</span><br><span class="line">-DCMAKE_SYSTEM_NAME=Linux \</span><br><span class="line">-DCMAKE_SYSTEM_VERSION=1 \</span><br><span class="line">-DCMAKE_SYSTEM_PROCESSOR=aarch64 \</span><br><span class="line">-DCMAKE_C_COMPILER=$cross_compile_toolchain/bin/aarch64-linux-gnu-gcc \</span><br><span class="line">-DCMAKE_CXX_COMPILER=$cross_compile_toolchain/bin/aarch64-linux-gnu-g++</span><br><span class="line">make -j4</span><br></pre></td></tr></table></figure>
<p>最开始编译的时候遇到了一个类型转换的问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[ 36%] Built target MNNTransform</span><br><span class="line">[ 36%] Built target MNNUtils</span><br><span class="line">[ 36%] Building CXX object CMakeFiles&#x2F;MNNCPU.dir&#x2F;source&#x2F;backend&#x2F;cpu&#x2F;compute&#x2F;WinogradInt8Helper.cpp.o</span><br><span class="line">&#x2F;data&#x2F;mnn&#x2F;source&#x2F;backend&#x2F;cpu&#x2F;compute&#x2F;WinogradInt8Helper.cpp: In function &#39;void MNN::TRANS_4x4(MNN::VecType&amp;, MNN::VecType&amp;, MNN::VecType&amp;, MNN::VecType&amp;)&#39;:</span><br><span class="line">&#x2F;data&#x2F;mnn&#x2F;source&#x2F;backend&#x2F;cpu&#x2F;compute&#x2F;WinogradInt8Helper.cpp:39:48: note: use -flax-vector-conversions to permit conversions between vectors with differing element types or numbers of subparts</span><br><span class="line">     auto m0 &#x3D; vtrn1q_s32(vec0.value, vec1.value), m1 &#x3D; vtrn2q_s32(vec0.value, vec1.value);</span><br><span class="line">                                                ^</span><br><span class="line">&#x2F;data&#x2F;mnn&#x2F;source&#x2F;backend&#x2F;cpu&#x2F;compute&#x2F;WinogradInt8Helper.cpp:39:48: error: cannot convert &#39;int8x16_t &#123;aka __vector(16) signed char&#125;&#39; to &#39;int32x4_t &#123;aka __vector(4) int&#125;&#39; for argument &#39;1&#39; to &#39;int32x4_t vtrn1q_s32(int32x4_t, int32x4_t)&#39;</span><br><span class="line">&#x2F;data&#x2F;mnn&#x2F;source&#x2F;backend&#x2F;cpu&#x2F;compute&#x2F;WinogradInt8Helper.cpp:40:48: error: cannot convert &#39;int8x16_t &#123;aka __vector(16) signed char&#125;&#39; to &#39;int32x4_t &#123;aka __vector(4) int&#125;&#39; for argument &#39;1&#39; to &#39;int32x4_t vtrn1q_s32(int32x4_t, int32x4_t)&#39;</span><br><span class="line">     auto m2 &#x3D; vtrn1q_s32(vec2.value, vec3.value), m3 &#x3D; vtrn2q_s32(vec2.value, vec3.value);</span><br><span class="line">                                                ^</span><br><span class="line">&#x2F;data&#x2F;mnn&#x2F;source&#x2F;backend&#x2F;cpu&#x2F;compute&#x2F;WinogradInt8Helper.cpp:42:29: error: &#39;m1&#39; was not declared in this scope</span><br><span class="line">     vec1.value &#x3D; vtrn1q_s64(m1, m3);</span><br><span class="line">                             ^~</span><br><span class="line">&#x2F;data&#x2F;mnn&#x2F;source&#x2F;backend&#x2F;cpu&#x2F;compute&#x2F;WinogradInt8Helper.cpp:42:33: error: &#39;m3&#39; was not declared in this scope</span><br><span class="line">     vec1.value &#x3D; vtrn1q_s64(m1, m3);</span><br><span class="line">                                 ^~</span><br><span class="line">CMakeFiles&#x2F;MNNCPU.dir&#x2F;build.make:2054: recipe for target &#39;CMakeFiles&#x2F;MNNCPU.dir&#x2F;source&#x2F;backend&#x2F;cpu&#x2F;compute&#x2F;WinogradInt8Helper.cpp.o&#39; failed</span><br><span class="line">make[2]: *** [CMakeFiles&#x2F;MNNCPU.dir&#x2F;source&#x2F;backend&#x2F;cpu&#x2F;compute&#x2F;WinogradInt8Helper.cpp.o] Error 1</span><br><span class="line">CMakeFiles&#x2F;Makefile2:141: recipe for target &#39;CMakeFiles&#x2F;MNNCPU.dir&#x2F;all&#39; failed</span><br><span class="line">make[1]: *** [CMakeFiles&#x2F;MNNCPU.dir&#x2F;all] Error 2</span><br><span class="line">Makefile:129: recipe for target &#39;all&#39; failed</span><br><span class="line">make: *** [all] Error 2</span><br></pre></td></tr></table></figure>
<p>参考官方github上的<a href="https://github.com/alibaba/MNN/pull/1560" target="_blank" rel="noopener">#1560</a>即可解决。</p>
<h2 id="2-OpenCV编译"><a href="#2-OpenCV编译" class="headerlink" title="2. OpenCV编译"></a>2. OpenCV编译</h2><p>其实没啥好说的，主要是有些组件需要在线拉取，国内这个网络环境实在是令人无语，花了几个美元租了国外的云服务，直接编译就可以。编译方法参考<a href="https://docs.opencv.org/4.5.2/d7/d9f/tutorial_linux_install.html" target="_blank" rel="noopener">官方教程</a>即可。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/11/Coding/RK3399/2021-07-11-D2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/11/Coding/RK3399/2021-07-11-D2/" class="post-title-link" itemprop="url">D2:开发环境搭建</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-11 11:11:00" itemprop="dateCreated datePublished" datetime="2021-07-11T11:11:00+08:00">2021-07-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本来以为可以很顺利地开始玩耍了，结果只把开发环境搭建成功了，交叉编译MNN失败:(</p>
<h1 id="D2-开发环境搭建"><a href="#D2-开发环境搭建" class="headerlink" title="D2: 开发环境搭建"></a>D2: 开发环境搭建</h1><p>因为是为了兴趣而做的小开发，平时又太忙，基本都是零碎时间来敲代码，所以目标是在平时办公的装Windows10的笔记本上搭建开发环境，如果是Linux应该会方便很多。</p>
<h2 id="1-启动WSL2"><a href="#1-启动WSL2" class="headerlink" title="1. 启动WSL2"></a>1. 启动WSL2</h2><h3 id="开启虚拟机平台"><a href="#开启虚拟机平台" class="headerlink" title="开启虚拟机平台"></a>开启虚拟机平台</h3><p>用管理员权限打开PowerShell，运行以下命令。或者新建WSL2.bat脚本，以管理员权限运行。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart</span><br></pre></td></tr></table></figure>
<h3 id="安装WSL2内核"><a href="#安装WSL2内核" class="headerlink" title="安装WSL2内核"></a>安装WSL2内核</h3><p>下载<a href="https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi" target="_blank" rel="noopener">WSL2内核更新包</a>，相关说明可以查阅微软的<a href="https://docs.microsoft.com/zh-cn/windows/wsl/install-win10#step-4---download-the-linux-kernel-update-package" target="_blank" rel="noopener">文档</a>。</p>
<p>重启系统后，用管理员权限打开PowerShell，运行以下命令，将WSL2设置为默认版本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --set-default-version 2</span><br></pre></td></tr></table></figure>
<h2 id="2-安装DOCKER"><a href="#2-安装DOCKER" class="headerlink" title="2. 安装DOCKER"></a>2. 安装DOCKER</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>我安装的是<a href="https://desktop.docker.com/win/stable/amd64/66090/Docker%20Desktop%20Installer.exe" target="_blank" rel="noopener">Docker Desktop 3.5.1</a>，直接下载安装即可，注意勾选“Use WSL 2 based engine”选项。我的系统是家庭版，默认勾选此选项。</p>
<p><img src="/img/Coding/RK3399/D2-01.png" alt="Docker Desktop" title="Docker Desktop"></p>
<h3 id="修改镜像存储位置（可选操作）"><a href="#修改镜像存储位置（可选操作）" class="headerlink" title="修改镜像存储位置（可选操作）"></a>修改镜像存储位置（可选操作）</h3><p>由于系统盘空间有限，将Docker的默认根目录调整到数据盘。</p>
<ol>
<li><p>退出Docker Desktop</p>
</li>
<li><p>确认所有WSL应用已退出，所有应用都应该是stop状态</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --list -v</span><br></pre></td></tr></table></figure>
</li>
<li><p>迁移docker-desktop</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wsl --export docker-desktop "D:\DOCKER-ENGINE\docker-desktop.tar"</span><br><span class="line">wsl --unregister docker-desktop</span><br><span class="line">wsl --import docker-desktop D:\DOCKER-ENGINE\run "D:\DOCKER-ENGINE\docker-desktop.tar" --version 2</span><br></pre></td></tr></table></figure>
</li>
<li><p>迁移docker-desktop-data</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wsl --export docker-desktop-data "D:\DOCKER-ENGINE\docker-desktop-data.tar"</span><br><span class="line">wsl --unregister docker-desktop-data</span><br><span class="line">wsl --import docker-desktop-data D:\DOCKER-ENGINE\data "D:\DOCKER-ENGINE\docker-desktop-data.tar" --version 2</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="3-使用Ubuntu-18-04镜像建立开发容器"><a href="#3-使用Ubuntu-18-04镜像建立开发容器" class="headerlink" title="3. 使用Ubuntu 18.04镜像建立开发容器"></a>3. 使用Ubuntu 18.04镜像建立开发容器</h2><h3 id="建立基础容器"><a href="#建立基础容器" class="headerlink" title="建立基础容器"></a>建立基础容器</h3><ol>
<li><p>从<a href="https://hub.docker.com/_/ubuntu?tab=tags&amp;page=1&amp;ordering=last_updated" target="_blank" rel="noopener">Docker Hub</a>上直接拉取镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull ubuntu:18.04</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v D:\DOCKER-SHARE:\data --name toy-project ubuntu:18.04 bash</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="基础环境安装"><a href="#基础环境安装" class="headerlink" title="基础环境安装"></a>基础环境安装</h3><ol>
<li><p>更新源</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-install update</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装开发基础库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install repo git-core gitk git-gui gcc-arm-linux-gnueabihf u-boot-tools device-tree-compiler gcc-aarch64-linux-gnu mtools parted libudev-dev libusb-1.0-0-dev python-linaro-image-tools linaro-image-tools gcc-arm-linux-gnueabihf libssl-dev liblz4-tool genext2fs lib32stdc++6 gcc-aarch64-linux-gnu g+conf autotools-dev libsigsegv2 m4 intltool libdrm-dev curl sed make binutils build-essential gcc g++ bash patch gzip bzip2 perl tar cpio python unzip rsync file bc wget libncurses5 libqt4-dev libglib2.0-dev libgtk2.0-dev libglade2-dev cvs git mercurial rsync openssh-client subversion asciidoc w3m dblatex graphviz python-matplotlib libssl-dev texinfo fakeroot libparse-yapp-perl default-jre patchutils lib32gcc-7-dev g++-7 libstdc++-7-dev</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用交叉编译工具链</p>
<p>下载工具链，我用的是<a href="https://releases.linaro.org/components/toolchain/binaries/latest-7/aarch64-linux-gnu/" target="_blank" rel="noopener">Linaro工具链</a>，按常规方式编译程序，例如MNN的示例是</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">export cross_compile_toolchain=linaro/aarch64</span><br><span class="line">mkdir build &amp;&amp; cd build</span><br><span class="line">cmake .. \</span><br><span class="line">-DCMAKE_SYSTEM_NAME=Linux \</span><br><span class="line">-DCMAKE_SYSTEM_VERSION=1 \</span><br><span class="line">-DCMAKE_SYSTEM_PROCESSOR=aarch64 \</span><br><span class="line">-DCMAKE_C_COMPILER=$cross_compile_toolchain/bin/aarch64-linux-gnu-gcc \</span><br><span class="line">-DCMAKE_CXX_COMPILER=$cross_compile_toolchain/bin/aarch64-linux-gnu-g++</span><br><span class="line">make -j4</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/07/Coding/RK3399/2021-07-07-D1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/07/Coding/RK3399/2021-07-07-D1/" class="post-title-link" itemprop="url">D1:RK3399Pro操作系统Ubuntu安装</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-07 23:00:00" itemprop="dateCreated datePublished" datetime="2021-07-07T23:00:00+08:00">2021-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>离开一线技术研发有点久了，最近一直在做偏市场和研发管理的角色。总觉得应该稍微调整一下，听从一个前辈的建议：每天都做一点自己感兴趣的小项目，让自己对技术保持嗅觉。因此，打算鼓捣鼓捣点RK3399Pro上的小东西。</p>
<h1 id="D1-RK3399Pro操作系统Ubuntu安装"><a href="#D1-RK3399Pro操作系统Ubuntu安装" class="headerlink" title="D1: RK3399Pro操作系统Ubuntu安装"></a>D1: RK3399Pro操作系统Ubuntu安装</h1><p>我购买的是Firefly RK3399Pro JD4开发板，配有核心板和底板。商家还贴心的给了一个U盘，内有各种工具和文档。因为我自己不会安装开发，第一件事就是把板子的系统重新烧成Ubuntu18.04。</p>
<h2 id="0-连接开发板"><a href="#0-连接开发板" class="headerlink" title="0. 连接开发板"></a>0. 连接开发板</h2><p>开发板上电，通过USB口连接PC主机。</p>
<h2 id="1-安装USB驱动助手"><a href="#1-安装USB驱动助手" class="headerlink" title="1. 安装USB驱动助手"></a>1. 安装USB驱动助手</h2><p>在PC主机上直接打开“DriverInstall.exe”，安装USB驱动</p>
<p><img src="/img/Coding/RK3399/00.PNG" alt="安装驱动" title="安装驱动"></p>
<h2 id="2-烧录系统"><a href="#2-烧录系统" class="headerlink" title="2. 烧录系统"></a>2. 烧录系统</h2><p>首先，准备好固件镜像。例如我选用的是“AIO-RK3399PRO-JD4-Ubuntu_18.04.5_LTS_DESKTOP_PYTHON3.5-RKNN-OPENCV-20210413-1746.img”，基本的环境都已经安装后，后续使用比较方便。如果需要做极致优化，再考虑手动编译内核和库的安装。</p>
<p>其次，烧系统。使用“AndroidTool.exe”进行固件烧录，虽然叫AndroidTool，但是也可以烧录Ubuntu系统。在“Update Firmware”标签页中，点击“Firmware”选择上述固件路径。</p>
<p>最后，注意连接开发板。按住开发板上的Recovery键，轻按Reset键，直到烧录工具显示“Found One LOADER Device”，松开按键。点击Upgrade开始烧录。烧录进度完成后，重启连接屏幕，即可进入Ubuntu桌面系统。</p>
<p><img src="/img/Coding/RK3399/02.PNG" alt="烧录系统" title="烧录系统"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/05/04/Life_Discovery/Little_Things/2021-05-04-May-4th/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/04/Life_Discovery/Little_Things/2021-05-04-May-4th/" class="post-title-link" itemprop="url">May the 4th Be with You!</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-05-04 12:44:00" itemprop="dateCreated datePublished" datetime="2021-05-04T12:44:00+08:00">2021-05-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Life-Discovery/" itemprop="url" rel="index"><span itemprop="name">Life Discovery</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>May the 4th, May the Force be With You!</p>
<p><img src="/img/LifeDiscovery/20210504.jpg" alt="May the 4th Be with You!" title="May the 4th Be with You!"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/04/18/Life_Discovery/Little_Things/2021-04-18-The-Fellowship-of-the-Ring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/18/Life_Discovery/Little_Things/2021-04-18-The-Fellowship-of-the-Ring/" class="post-title-link" itemprop="url">The Fellowship of the Ring</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-18 13:44:00" itemprop="dateCreated datePublished" datetime="2021-04-18T13:44:00+08:00">2021-04-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Life-Discovery/" itemprop="url" rel="index"><span itemprop="name">Life Discovery</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>“I wish it need not have happened in my time,” said Frodo.</p>
<p>“So do I,H said Gandalf, “and so do all who live to see such times. But that is not for them to decide. All we have to decide is what to do with the time that is given us.”</p>
</blockquote>
<p><img src="/img/LifeDiscovery/20210418.jpg" alt="The Fellowship of the Ring" title="The Fellowship of the Ring"></p>
<p>It’s great to see the movie in cinema again.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/04/05/Life_Discovery/Little_Things/2021-04-05-Presentation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/05/Life_Discovery/Little_Things/2021-04-05-Presentation/" class="post-title-link" itemprop="url">做汇报</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-05 12:03:00" itemprop="dateCreated datePublished" datetime="2021-04-05T12:03:00+08:00">2021-04-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Life-Discovery/" itemprop="url" rel="index"><span itemprop="name">Life Discovery</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>说起做汇报，我总有点发愁。</p>
<p>先得苦苦思索一个大纲，这报告是什么场合，目的是什么，先讲这个还是先讲那个。要是对方是个外行，不关心技术还好，如果非要了解技术实现过程，还得从技术原理讲起，讲技术原理实现路径明确了，可是大的逻辑又混乱了。</p>
<p>然后费劲吧啦做PPT，按道理有了大纲，做起来好像也不难，但是边做边找素材就又费体力脑力了，这个图不好看，那个图不合心意。一会儿上网搜一搜，一会儿自己画。除了素材不好找，做出来还得美观好看，字体字号是不是统一了，图文是不是平衡了，一大片空白总得填上些什么吧，一大段字谁会去读。做上这一页最少也得十分钟！</p>
<p>最后就是汇报现场，纯粹的技术汇报我还是有信心的，当然前提是自己的技术过关熟悉，要是做的不好或者有不熟悉的地方，心里总要打鼓的。另一种纯粹是为了商务开拓的话，就几本会战战栗栗、口干舌燥，最后搞一个大红脸。要是再分析个市场前景、未来规模什么的，那只能是邯郸学步，赶紧说完赶紧解脱。</p>
<p>发愁归发愁，该汇报还要汇报，硬着头皮来吧！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/04/04/Life_Discovery/Miscellaneous/2021-04-04-Spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/04/Life_Discovery/Miscellaneous/2021-04-04-Spring/" class="post-title-link" itemprop="url">Tender Spring</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-04-04 21:56:00" itemprop="dateCreated datePublished" datetime="2021-04-04T21:56:00+08:00">2021-04-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Life-Discovery/" itemprop="url" rel="index"><span itemprop="name">Life Discovery</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Spring-the-sweet-spring"><a href="#Spring-the-sweet-spring" class="headerlink" title="Spring, the sweet spring"></a>Spring, the sweet spring</h1><p><strong>BY THOMAS NASHE</strong></p>
<p>Spring, the sweet spring, is the year’s pleasant king,<br>Then blooms each thing, then maids dance in a ring,<br>Cold doth not sting, the pretty birds do sing:<br>Cuckoo, jug-jug, pu-we, to-witta-woo!</p>
<p>The palm and may make country houses gay,<br>Lambs frisk and play, the shepherds pipe all day,<br>And we hear aye birds tune this merry lay:<br>Cuckoo, jug-jug, pu-we, to-witta-woo!</p>
<p>The fields breathe sweet, the daisies kiss our feet,<br>Young lovers meet, old wives a-sunning sit,<br>In every street these tunes our ears do greet:<br>Cuckoo, jug-jug, pu-we, to witta-woo!</p>
<p>Spring, the sweet spring!</p>
<p><img src="/img/LifeDiscovery/20210404.jpg" alt="2021.04.04" title="2021.04.04"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/04/Computer_Vision/Reading_Note/2020-07-04-DCL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/04/Computer_Vision/Reading_Note/2020-07-04-DCL/" class="post-title-link" itemprop="url">Reading Note: Destruction and Construction Learning for Fine-grained Image Recognition</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-04 12:11:00" itemprop="dateCreated datePublished" datetime="2020-07-04T12:11:00+08:00">2020-07-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computer-Vision/" itemprop="url" rel="index"><span itemprop="name">Computer Vision</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>TITLE</strong>: Destruction and Construction Learning for Fine-grained Image Recognition</p>
<p><strong>AUTHOR</strong>: Yue Chen, Yalong Bai, Wei Zhang, Tao Mei</p>
<p><strong>ASSOCIATION</strong>: JD AI Research</p>
<p><strong>FROM</strong>: <a href="https://arxiv.org/abs/2003.14142" target="_blank" rel="noopener">arXiv:2003.14142</a></p>
<h2 id="CONTRIBUTION"><a href="#CONTRIBUTION" class="headerlink" title="CONTRIBUTION"></a>CONTRIBUTION</h2><ol>
<li>A novel “Destruction and Construction Learning (DCL)” framework is proposed for fine-grained recognition.For destruction, the region confusion mechanism (RCM) forces the classification network to learn from discriminative regions, and the adversarial loss prevents over-fitting the RCM-induced noisy patterns. For construction, the region alignment network re- stores the original region layout by modeling the semantic correlation among regions.</li>
<li>State-of-the-art performances are reported on three standard benchmark datasets, where DCL consistently outperforms existing methods.</li>
<li>Compared to existing methods, proposed DCL does not need extra part/object annotation and introduces no computational overhead at inference time.</li>
</ol>
<h2 id="METHOD"><a href="#METHOD" class="headerlink" title="METHOD"></a>METHOD</h2><p>The proposed method consists of four parts as the following figure shows. </p>
<p><img src="/img/ReadingNote/20200704/framework.png" alt="Framework" title="Framework"></p>
<p>At training stage, three losses are used, including classification loss, adversarial loss and region alignment loss. The loss can be defined as</p>
<script type="math/tex; mode=display">L = \alpha L_{cls} + \beta L_{adv} + \gamma L_{loc}</script><p>The three losses play different roles in this work.</p>
<h3 id="Classification-Network"><a href="#Classification-Network" class="headerlink" title="Classification Network"></a>Classification Network</h3><p>At inference stage, only this part of the network is used. And this part introduces the classification loss $L_{cls}$.</p>
<h3 id="Region-Confuston-Mechanism"><a href="#Region-Confuston-Mechanism" class="headerlink" title="Region Confuston Mechanism"></a>Region Confuston Mechanism</h3><p>Given an input image, the image is first uniformly partioned into $N \times N$ sub-regions. Then the sub-regions are rearranged whithin neighbourhood. This shuffling method destructs the global structure and ensures that the local region jitters inside its neighbourhood with a tunable size. Since the global structure has been destructed, to recognize these randomly shuffled images, the classification network has to find the discriminative regions and learn the delicate differences among categories.</p>
<h3 id="Adversarial-Learning-Network"><a href="#Adversarial-Learning-Network" class="headerlink" title="Adversarial Learning Network"></a>Adversarial Learning Network</h3><p>Destructing images with RCM does not always bring beneficial information for fine-grained classification. Features learned from these noise visual patterns are harmful to the classification task. Thus adversarial loss $L_{adv}$ is introduced to prevent such overfitting. This loss helps the filters to response differently on original images and region-shuffled images. Thus the network can work reliabally.</p>
<h3 id="Region-Alignment-Network"><a href="#Region-Alignment-Network" class="headerlink" title="Region Alignment Network"></a>Region Alignment Network</h3><p>The direct aim of the Region Alignment Network is to restore the original image from the scattered image. By end-to-end training, the region alignment loss $L_{loc}$ can help the classification backbone network to build deep understanding about objects and model the structure information, such as the shape of objects and semantic correlation among parts of object.</p>
<h2 id="PERFORMANCE"><a href="#PERFORMANCE" class="headerlink" title="PERFORMANCE"></a>PERFORMANCE</h2><p>The following table shows the comparison between this work and prior work.</p>
<p><img src="/img/ReadingNote/20200704/performance.png" alt="performance" title="performance"></p>
<p><img src="/img/ReadingNote/20200704/ablation.png" alt="ablation" title="ablation"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/02/Computer_Vision/Reading_Note/2020-07-02-APCNN/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-icon.png">
      <meta itemprop="name" content="Joshua LI">
      <meta itemprop="description" content="Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Joshua's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/02/Computer_Vision/Reading_Note/2020-07-02-APCNN/" class="post-title-link" itemprop="url">Reading Note: Weakly Supervised Attention Pyramid Convolutional Neural Network for Fine-Grained Visual Classification</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-02 19:58:00" itemprop="dateCreated datePublished" datetime="2020-07-02T19:58:00+08:00">2020-07-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-19 17:11:04" itemprop="dateModified" datetime="2022-08-19T17:11:04+08:00">2022-08-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computer-Vision/" itemprop="url" rel="index"><span itemprop="name">Computer Vision</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>TITLE</strong>: Weakly Supervised Attention Pyramid Convolutional Neural Network for Fine-Grained Visual Classification</p>
<p><strong>AUTHOR</strong>: Yifeng Ding, Shaoguo Wen, Jiyang Xie, Dongliang Chang, Zhanyu Ma, Zhongwei Si, Haibin Ling</p>
<p><strong>ASSOCIATION</strong>: Beijing University of Posts and Telecommunications, Stony Brook University</p>
<p><strong>FROM</strong>: <a href="https://arxiv.org/abs/2002.03353" target="_blank" rel="noopener">arXiv:2002.03353</a></p>
<h2 id="CONTRIBUTION"><a href="#CONTRIBUTION" class="headerlink" title="CONTRIBUTION"></a>CONTRIBUTION</h2><ol>
<li>A novel attention pyramid convolutional neural network (AP-CNN) is propsed by building an enhanced pyramidal hierarchy, which combines a top-down pathway of features and a bottom-up pathway of attentions, and thus learns both high-level semantic and low-level detailed feature representations.</li>
<li>ROI guided refinement is proposed which consists of ROI guided dropblock and ROI guided zoom-in to further refine the features. The dropblock operation helps to locate more discriminative local regions, and the zoom-in operation aligns features with background noises eliminated.</li>
</ol>
<h2 id="METHOD"><a href="#METHOD" class="headerlink" title="METHOD"></a>METHOD</h2><p>AP-CNN is a two-stage network, raw-stage and refined-stage, that respectively takes coarse full images and refined features as input. An overview of the proposed AP-CNN is illustrated in the following figure.</p>
<p><img src="/img/ReadingNote/20200702/overview.png" alt="Overview" title="Overview"></p>
<p>First, the feature and attention pyramid structure takes coarse images as input, which generates the pyramidal features and the pyramidal attentions by establishing hierarchy on the basic CNN following a top-down feature pathway and a bottom-up attention pathway.</p>
<p>Second, once the spatial attention pyramid has been obtained from the raw input, the region proposal network (RPN) proceeds to generate the pyramidal regions of interest (ROIs) in a weakly supervised way. Then the ROI guided refinement is conducted on low-level features with a) the ROI guided dropblock which erases the most discriminative regions selected from small-scaled ROIs, and b) the ROI guided zoom-in which locates the major regions merged from all ROIs.</p>
<p>Third, the refined features are sent into the refined-stage to distill more discriminative information. Both stages set individual classifiers for each pyramid level, and the final classification result is averaged over the raw-stage predictions and the refined-stage predictions.</p>
<p>The Attention Pyramid consists of two types of attentions, Spatial Attention and Channel Attention. The following figure shows the data-flow.</p>
<p><img src="/img/ReadingNote/20200702/attention.png" alt="attention" title="attention"></p>
<p>Spatial Attention Pyramid is a set of feature maps of different resolutions and is generated from feature pyramid. Then ROI pyramid is generated from the spatial activations using RPN. At training stage, a ROI is selected to be droped, erasing the informative part and encouraging the network to find more discriminative regions. At testing stage, this operation is skipped. The following figure shows the ROI guided refinement.</p>
<p><img src="/img/ReadingNote/20200702/roi_dropblock.png" alt="roi_dropblock" title="roi_dropblock"></p>
<h2 id="PERFORMANCE"><a href="#PERFORMANCE" class="headerlink" title="PERFORMANCE"></a>PERFORMANCE</h2><p>The following table shows the comparison between this work and prior work.</p>
<p><img src="/img/ReadingNote/20200702/performance.png" alt="performance" title="performance"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Joshua LI"
      src="/images/avatar-icon.png">
  <p class="site-author-name" itemprop="name">Joshua LI</p>
  <div class="site-description" itemprop="description">Do not aim for success if you want it; just do what you love and believe in, and it will come naturally.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">239</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">58</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/joshua19881228" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;joshua19881228" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:zhixuan.1988.li@gmail.com" title="E-Mail → mailto:zhixuan.1988.li@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/joshua1988" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;joshua1988" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Joshua LI</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


</body>
</html>
